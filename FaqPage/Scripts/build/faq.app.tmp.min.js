!function(){"use strict";angular.module("FaqApp.controllers",[]),angular.module("FaqApp.services",[]),angular.module("FaqApp.directives",[]),angular.module("FaqApp.filters",[]),angular.module("ViewFaqApp",["FaqApp.controllers","FaqApp.services","FaqApp.directives","FaqApp.filters","ngRoute","ngSanitize","ngAnimate","ui.bootstrap","ui.sortable","ui.select","angular-sortable-view"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/FaqList.html",controller:"FaqViewCtrl"}).otherwise({redirectTo:"/"})}]).config(["$logProvider",function(a){a.debugEnabled(window.faq_is_debug)}]),angular.module("EditFaqApp",["FaqApp.controllers","FaqApp.services","FaqApp.directives","ngRoute","ngSanitize","ngAnimate","ui.bootstrap","ui.sortable","ngToast","ui.select","angular-sortable-view"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/EditMode/FaqEditStartScreen.html",controller:"FaqEditCtrl"}).when("/SelectForEdit",{templateUrl:"partials/EditMode/SelectFaqSetForEdit.html",controller:"SelectFaqForEditCtrl"}).when("/ConnectFaqSet",{templateUrl:"partials/EditMode/ConnectFaqSet.html",controller:"ConnectFaqSetCtrl"}).when("/NewFaqSet",{templateUrl:"partials/EditMode/NewFaqSet.html",controller:"FaqEditCtrl"}).when("/ManageFaqSet/:folderUrl",{templateUrl:"partials/EditMode/ManageFaqSet.html",controller:"ManageFaqSetCtrl"}).when("/ManageFaqSet/:folderUrl/faq/edit/:faqId",{templateUrl:"partials/EditMode/CreateEditFaq.html",controller:"CreateEditFaqCtrl"}).when("/ManageFaqSet/:folderUrl/faq/new",{templateUrl:"partials/EditMode/CreateEditFaq.html",controller:"CreateEditFaqCtrl"}).when("/Licensing",{templateUrl:"partials/EditMode/LicenseRequest.html",controller:"RegisterAppCtrl"}).when("/ContactDev",{templateUrl:"partials/EditMode/ContactDeveloper.html",controller:"ContactDeveloperCtrl"}).otherwise({redirectTo:"/"})}]).config(["$logProvider",function(a){a.debugEnabled(window.faq_is_debug)}]).config(["ngToastProvider",function(a){window.parent!==window&&-1!==window.location.href.indexOf("FaqAppPartEditMode.aspx")&&a.configure({horizontalPosition:"center",verticalPosition:"bottom"})}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("CommonFaqSetSettingsCtrl",["$scope","faqService","processing","$routeParams","$timeout","$jq","animationList","ngToast",function(a,b,c,d,e,f,g,h){c.initilize(a);var i;a.viewDeferred=b.faqRepository.getRootFolders(),a.viewDeferred.then(function(b){i=f.grep(b,function(a){return a.title===d.folderUrl?!0:!1})[0],a.faqSettings=i.faqSetSettings,a.setSelectedAnimation(a.faqSettings.animation)}),a.setSelectedAnimation=function(b){a.selectedAnimation=g[b],a.playingAnimation=b,a.faqSettings.animation=b},a.testAnimation=function(){a.playingAnimation=a.faqSettings.animation},a.saveSettings=function(){i.faqSetSettings=a.faqSettings,a.viewDeferred=b.faqRepository.saveItem(i),h.create({content:a.Resources.DataSaved})}}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("ConnectFaqSetCtrl",["processing","$scope","$q","$jq","faqService","context","ngToast","$timeout",function(a,b,c,d,e,f,g,h){a.initilize(b);var i=f.wpId;b.resize=function(){h(function(){e.resizeParent()},100)},b.selectedFolders=[],b.viewDeferred=c.all([e.faqRepository.getRootFolders(),e.appPartConfigRepository.getByAppPartId(i)]),b.viewDeferred.then(function(a){var c=a[0],d=a[1];d?(b.searchEnabled=d.configData.searchEnabled,b.filterEnabled=d.configData.filterEnabled,b.customCssEnabled=d.configData.customCssEnabled,d.configData.customCssLink||(d.configData.customCssLink=f.spAppWebUrl+"Lists/Documents/FaqCustomStyles.css"),b.customCssLink=d.configData.customCssLink,d.configData.folderId&&(d.configData.faqSetInfo=[],d.configData.faqSetInfo.push({order:1,folderId:d.configData.folderId})),Array.forEach(d.configData.faqSetInfo,function(a){var d=c.map(function(a){return a.id}).indexOf(a.folderId);if(-1!==d){var e=c.splice(d,1)[0];e.order=a.order,b.selectedFolders.push(e)}})):b.customCssLink=f.spAppWebUrl+"Lists/Documents/FaqCustomStyles.css",b.selectedFolders.sort(function(a,b){return a.order-b.order}),b.folders=c,b.resize()},function(a){alert(a.message)}),b.connectAppPart=function(){e.appPartConfigRepository.getByAppPartId(i).then(function(a){a||(a=new AppPartConfigListItem,a.wpId=i,a.configData={});var c=b.selectedFolders.map(function(a,b){return{order:b,folderId:a.id}});a.configData.folderId&&delete a.configData.folderId,a.configData.faqSetInfo=c,a.configData.searchEnabled=b.searchEnabled,a.configData.filterEnabled=b.filterEnabled,a.configData.customCssEnabled=b.customCssEnabled,a.configData.customCssLink=b.customCssLink,e.appPartConfigRepository.saveItem(a).then(function(){g.create({content:b.Resources.DataSaved,horizontalPosition:"center",verticalPosition:"bottom"}),b.$apply()},function(a){alert(a.message)})},function(a){alert(a.message)})}}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("ContactDeveloperCtrl",["$scope","processing",function(a,b){b.initilize(a)}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("CreateEditFaqCtrl",["$scope","$sce","$routeParams","$q","faqService","processing","ngToast",function(a,b,c,d,e,f,g){function h(){a.faqItem=i,a.$watch("faqItem.question",function(){a.question=a.getInnerText(i.question)}),a.$watch("faqItem.answer",function(){a.answer=a.getInnerText(i.answer)}),a.saveFaq=function(){if(a.submitted=!0,!a.faqForm.$invalid){var b=d.defer();a.viewDeferred=b.promise,e.faqRepository.getLastItem().then(function(d){i.order||(i.order=d?d.id+1:1),e.faqRepository.saveItem(i).then(function(){g.create({content:a.Resources.QuestionSaved}),b.resolve(),a.go(String.format("/ManageFaqSet/{0}",c.folderUrl))},function(a){b.resolve(),alert(a.message)})},function(a){b.resolve(),alert(a.message)})}},a.back=function(){a.go(String.format("/ManageFaqSet/{0}",c.folderUrl))}}f.initilize(a);var i;e.faqRepository.folder=c.folderUrl,c.faqId?e.faqRepository.getItemById(parseInt(c.faqId,10)).then(function(b){i=b,h(),a.$apply()},function(a){alert(a.message)}):(i=new FaqListItem,i.expanded=!0,h())}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("FaqEditCtrl",["$scope","$sce","faqService","$location","faqSetModel","processing","context",function(a,b,c,d,e,f,g){f.initilize(a),e.faqSetName="",a.faqSetModel=e,a.wpIdProvided=!!g.wpId,a.newFaqSet=function(){a.submitted=!0,a.faqForm.$invalid||(a.createFolderDeferred=c.faqRepository.createFaqFolder(e.faqSetName,{useAnimation:!1,showPlusSymbol:!0,animation:"cshow"}),a.createFolderDeferred.then(function(){a.go(String.format("/ManageFaqSet/{0}",e.faqSetName)),a.$apply()},function(b){a.folderExists=b.errorCode===FAQ.ErrorCodes.FolderAlreadyExists,a.illegalCharacter=b.errorCode===FAQ.ErrorCodes.IllegalName,a.folderExists||a.illegalCharacter||(a.commonError=!0,a.errorMessage=b.message),a.$apply()}))}}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("FaqViewCtrl",["$scope","$sce","$q","$timeout","faqService","processing","context","$log","$window","$jq",function(a,b,c,d,e,f,g,h,i,j){f.initilize(a);var k=2,l=200;if(a.selectedFolders={},a.selectedFolders.folders=[],a.faqItems=null,a.appPartInitialized=!0,g.editMode){var m=String.format("{0}FaqAppPartEditMode.aspx{1}#/ConnectFaqSet",g.spAppWebUrl,i.location.search);return h.debug(m),void(i.location.href=m)}var n=g.wpId,o=c.defer();a.viewDeferred=o.promise,a.changeVisibility=function(a,b){b.forceExpand||(b.playingAnimation=b.$parent.faqFolder.faqSetSettings.animation,a.isShown=!a.isShown,a.expanded=!a.expanded)},a.clearSearch=function(){a.searchText&&(a.searchText="",d(function(){e.resizeParent()},100))},a.filterByQuestionAnswer=function(b){if(!a.searchText)return!0;var c=a.searchText.toLowerCase();return-1!==b.question.toLowerCase().indexOf(c)||-1!==b.answer.toLowerCase().indexOf(c)},a.filterBySelectedFolders=function(b){if(0===a.selectedFolders.folders.length)return!0;var c=j.grep(a.selectedFolders.folders,function(a){return b.id===a.id});return 1===c.length},a.resize=function(){d(function(){e.resizeParent()},100)},a.initScope=function(a,b){b.playingAnimation=a.faqSetSettings.animation,b.showPlusSymbol=a.faqSetSettings.showPlusSymbol,b.forceExpand=a.faqSetSettings.useAnimation===!1},e.appPartConfigRepository.getByAppPartId(n).then(function(b){b?(b.configData.folderId&&(b.configData.faqSetInfo=[],b.configData.faqSetInfo.push({order:1,folderId:b.configData.folderId})),a.customCssEnabled=b.configData.customCssEnabled,a.customCssLink=b.configData.customCssLink,a.$apply(),e.faqRepository.getItemsByIds(b.configData.faqSetInfo.map(function(a){return a.folderId})).then(function(c){h.debug(c),e.faqRepository.getItemsInsideFolders(c.map(function(a){return a.title})).then(function(d){h.debug(d),Array.forEach(d,function(a){a.isShown=a.expanded}),Array.forEach(c,function(a){var c=j.grep(d,function(b){return-1!==b.fileDirRef.indexOf(a.title)?!0:!1}),e=j.grep(b.configData.faqSetInfo,function(b){return b.folderId===a.id?!0:!1})[0];a.faqItems=c,a.order=e.order}),a.showSearch=b.configData.searchEnabled,a.showFilter=b.configData.filterEnabled,a.loadedFolders=c,a.faqItems=d,o.resolve(),a.$apply(),e.resizeParent(),h.debug("faqService.resizeParent()");var f=setInterval(function(){k--,0===k&&clearInterval(f),e.resizeParent(),h.debug("faqService.resizeParent() - interval")},1*l)},function(a){o.resolve(),alert(a.message)})},function(a){o.resolve(),alert(a.message)})):(a.appPartInitialized=!1,o.resolve(),a.$apply())},function(a){o.resolve(),alert(a.message)})}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("LicensingCtrl",["$scope","faqService","$location","$q","processing","licenseStatus","licensing","context","$window",function(a,b,c,d,e,f,g,h,i){e.initilize(a),a.lockDeferred=g.getLicenseStatus(),a.isAppPart=window.parent!==window,a.showIfLicenseValid=function(){return a.licensed||a.underTrial},a.lockDeferred.then(function(b){a.underTrial=b.status===f.UnderTrial,a.licensed=b.status===f.Licensed,a.trialExpired=b.status===f.TrialExpired,a.licenseNotValid=b.status===f.LicenseNotValid,a.daysLeft=b.daysLeft,a.assetId=b.assetId},function(b){a.licenseNotValid=!0,alert(b.message)}),a.navigateToBuy=function(){var b=String.format("{0}_layouts/15/storefront.aspx?source={1}#vw=AppDetailsView,app={2},clg=0,bm=US,cm=en-US",h.spHostUrl,encodeURIComponent(i.location.href),a.assetId);a.isAppPart?i.open(b,"_blank"):i.location.href=b}}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("ManageFaqSetCtrl",["$scope","$sce","faqService","$location","faqSetModel","processing","$modal","$routeParams",function(a,b,c,d,e,f,g,h){f.initilize(a),e.faqSetName=h.folderUrl,a.faqSetModel=e,a.activeTab="tab1",c.faqRepository.folder=h.folderUrl,a.viewDeferred=c.faqRepository.getOrderedItems(),a.viewDeferred.then(function(b){Array.forEach(b,function(a){a.isShown=a.expanded}),a.faqItems=b,a.$apply()},function(a){alert(a.message)}),a.newFaq=function(){a.go(String.format("/ManageFaqSet/{0}/faq/new",h.folderUrl))},a.editFaq=function(b){a.go(String.format("/ManageFaqSet/{0}/faq/edit/{1}",h.folderUrl,b.id))},a.deleteFaq=function(b){var d=g.open({templateUrl:"deleteFaqModal.html",controller:"ModalInstanceCtrl",size:"sm"});d.result.then(function(){a.viewDeferred=c.faqRepository.deleteItem(b),a.viewDeferred.then(function(){var c=-1;Array.forEach(a.faqItems,function(a,d){return a.id===b.id?void(c=d):void 0}),c>-1&&a.faqItems.splice(c,1),a.$apply()},function(a){alert(a.message)})},function(){})},a.sortableOptions={placeholder:"sortable-placeholder",stop:function(){Array.forEach(a.faqItems,function(a,b){a.order=b}),a.viewDeferred=c.faqRepository.updateOrdering(a.faqItems),a.viewDeferred.then(function(){},function(a){alert(a.message)})}}}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("ModalInstanceCtrl",["$modalInstance","$scope","processing","$location",function(a,b,c){c.initilize(b),b.ok=function(){a.close()},b.cancel=function(){a.dismiss("cancel")}}])}(),function(){"use strict";angular.module("FaqApp.controllers").controller("SelectFaqForEditCtrl",["processing","$scope","faqService","$modal","$jq",function(a,b,c,d,e){a.initilize(b),b.viewDeferred=c.faqRepository.getRootFolders(),b.viewDeferred.then(function(a){b.folders=a,c.faqRepository.folder=null,b.$apply()},function(a){alert(a.message)}),b.editFaqSet=function(a){b.go(String.format("/ManageFaqSet/{0}",a.title))},b.deleteFaqSet=function(a){var e=d.open({templateUrl:"deleteFaqModal.html",controller:"ModalInstanceCtrl",size:"sm"});e.result.then(function(){b.viewDeferred=c.faqRepository.deleteItem(a),b.viewDeferred.then(function(){var c=-1;Array.forEach(b.folders,function(b,d){return b.id===a.id?void(c=d):void 0}),c>-1&&b.folders.splice(c,1),b.$apply()},function(a){alert(a.message)})},function(){})},b.revertFolderName=function(a,b){b.title=b.initialName,a.changed=a.submitted=!1},b.initScope=function(a,b){b.initialName=b.title,a.$watch("folder.title",function(){a.folder.fileLeafRef=a.folder.title})},b.changeFolderName=function(a,d){if(a.submitted=!0,!a.faqSetForm.$invalid){var f=e.grep(a.folders,function(a){return a.id===d.id&&a!=d?!0:!1}).length>0;if(f)return void(a.folderExists=!0);b.viewDeferred=c.faqRepository.saveItem(d),b.viewDeferred.then(function(){d.initialName=d.title,a.changed=a.submitted=!1,b.$apply()},function(c){a.folderExists=c.errorCode===FAQ.ErrorCodes.FolderAlreadyExists,a.illegalCharacter=c.errorCode===FAQ.ErrorCodes.IllegalName,a.folderExists||a.illegalCharacter||(a.commonError=!0,a.errorMessage=c.message),b.$apply()})}}}])}(),function(a){"use strict";angular.module("FaqApp.directives").directive("block",["$log",function(b){return a.blockUI.defaults.css={},a.blockUI.defaults.overlayCSS.backgroundColor="#FFF",a.blockUI.defaults.overlayCSS.cursor="default",{retstrict:"A",scope:{lock:"=block"},link:function(a,c){a.$watch("lock",function(){a.lock&&angular.isFunction(a.lock["finally"])&&(b.debug("Blocking..."),c.addClass("locked").block({message:"<img src='Content/img/ajax-loader.gif'>"}),a.lock["finally"](function(){b.debug("Unblocking..."),c.removeClass("locked").unblock()}))})}}}])}(jQuery),function(){"use strict";angular.module("FaqApp.directives").directive("contenteditable",[function(){return{require:"ngModel",link:function(a,b,c,d){b.on("blur",function(){a.$apply(function(){d.$setViewValue(b.html())})}),d.$render=function(){b.html(d.$viewValue)},d.$render()}}}])}(),function(){"use strict";angular.module("FaqApp.directives").directive("faqAnimate",["$timeout",function(a){return{retstrict:"A",scope:{animatationName:"="},link:function(b,c){b.$watch("animatationName",function(d,e){if(d!==e&&d){var f;f="cshow"===d?"ng-hide":"animated "+d,c.addClass(f),setTimeout(function(){c.removeClass(f)},1500)}a(function(){b.animatationName=""},100)})}}}])}(),function(){"use strict";angular.module("FaqApp.directives").directive("faqShow",["$animate","faqService","$log",function(a,b,c){return{retstrict:"A",scope:{faqShow:"=",animatationName:"="},link:function(a,d){a.$watch("faqShow",function(e,f){e!==f&&(e?(d.removeClass("ng-hide"),b.resizeParent(),d.addClass("animated "+a.animatationName),c.debug("addClass"),setTimeout(function(){d.removeClass("animated "+a.animatationName)},1e3)):(d.addClass("ng-hide"),b.resizeParent()))})}}}])}(),function(){"use strict";angular.module("FaqApp.directives").directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}})}(),function(){"use strict";angular.module("FaqApp.directives").directive("spEditable",[function(){return{restrict:"A",scope:{},link:function(a,b){b.addClass("ms-rte-layoutszone-inner-editable ms-rtestate-write").attr("role","textbox").attr("aria-haspopup","true").attr("contentEditable","true").attr("aria-autocomplete","both").attr("aria-autocomplete","both").attr("aria-multiline","true")}}}])}(),function(){"use strict";angular.module("FaqApp.filters").filter("faqhighlight",["$sce",function(a){return function(b,c){return c&&(b=b.replace(new RegExp(c,"gi"),"<span class='highlighted'>$&</span>")),a.trustAsHtml(b)}}])}(),function(){"use strict";angular.module("FaqApp.filters").filter("propsFilter",["$sce",function(){return function(a,b){var c=[];return angular.isArray(a)?a.forEach(function(a){for(var d=!1,e=Object.keys(b),f=0;f<e.length;f++){var g=e[f],h=b[g].toLowerCase();if(-1!==a[g].toString().toLowerCase().indexOf(h)){d=!0;break}}d&&c.push(a)}):c=a,c}}])}(),function(){"use strict";var a={};a.cshow=FAQRS.SimpleAnimation,a.fadeIn=FAQRS.FadeIn,a.fadeInUp=FAQRS.FadeInUp,a.fadeInRight=FAQRS.FadeInRight,a.fadeInLeft=FAQRS.FadeInLeft,a.fadeInDown=FAQRS.FadeInDown,a.bounceIn=FAQRS.BounceIn,a.bounceInLeft=FAQRS.BounceInLeft,a.bounceInRight=FAQRS.BounceInRight,a.bounceInUp=FAQRS.BounceInUp,a.bounceInDown=FAQRS.BounceInDown,a.flip=FAQRS.Flip,a.flipInX=FAQRS.FlipInX,a.flipInY=FAQRS.FlipInY,a.rotateIn=FAQRS.RotateIn,a.rotateInDownLeft=FAQRS.RotateInDownLeft,a.rotateInDownRight=FAQRS.RotateInDownRight,a.rotateInUpLeft=FAQRS.RotateInUpLeft,a.rotateInUpRight=FAQRS.RotateInUpRight,a.zoomIn=FAQRS.ZoomIn,a.zoomInUp=FAQRS.ZoomInUp,a.zoomInRight=FAQRS.ZoomInRight,a.zoomInLeft=FAQRS.ZoomInLeft,a.zoomInDown=FAQRS.ZoomInDown,a.pulse=FAQRS.Pulse,a.swing=FAQRS.Swing,a.tada=FAQRS.Tada,a.lightSpeedIn=FAQRS.LightSpeedIn,a.rollIn=FAQRS.RollIn,a.wobble=FAQRS.Wobble,angular.module("FaqApp.services").value("animationList",a)}(),function(){"use strict";angular.module("FaqApp.services").factory("context",[function(){function a(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}function b(b){var c=a(b);return c.endsWith("/")?c:c+"/"}var c=a("editmode"),d=!1;return c&&(d=!!parseInt(c,10)),{editMode:d,spHostUrl:b("SPHostUrl"),spAppWebUrl:b("SPAppWebUrl"),wpId:a("wpId"),senderId:a("SenderId"),isDebug:window.faq_is_debug,productId:window.faq_product_id}}])}(),function(){"use strict";angular.module("FaqApp.services").factory("faqService",["context",function(a){return{appPartConfigRepository:new AppPartsConfigRepository(FAQ.Lists.AppPartsConfigUrl),faqRepository:new FaqRepository(FAQ.Lists.FaqUrl),webService:FAQ.SPWebService,resizeParent:function(){if(window.parent!==window){var b=$jq("#ng-app-FaqApp"),c="<Message senderId="+a.senderId+" >resize("+(b.outerWidth()+30)+","+(b.outerHeight()+30)+")</Message>";window.parent.postMessage(c,a.spHostUrl)}}}}])}(),function(){"use strict";angular.module("FaqApp.services").factory("faqSetModel",[function(){return{faqSetName:""}}])}(),function(){"use strict";angular.module("FaqApp.services").factory("$jq",function(){return window.jQuery})}(),function(){"use strict";angular.module("FaqApp.services").value("licenseStatus",{UnderTrial:1,Licensed:2,TrialExpired:3,LicenseNotValid:4}),angular.module("FaqApp.services").value("entitlementType",{Free:"free",Paid:"paid",Trial:"trial"}),angular.module("FaqApp.services").factory("licensing",["context","$q","licenseStatus","storage","$jq","entitlementType","$log",function(a,b,c,d,e,f,g){function h(a){var b=e.xml2json(a).VerifyEntitlementTokenResponse;b.IsValid="true"===b.IsValid.toLowerCase(),b.IsEntitlementExpired="true"===b.IsEntitlementExpired.toLowerCase(),b.IsExpired="true"===b.IsExpired.toLowerCase(),g.debug(b);var d=b.EntitlementType.toLowerCase();switch(d){case f.Paid:k.resolve({status:c.Licensed,assetId:b.AssetId});break;case f.Free:k.resolve({status:c.Licensed,assetId:b.AssetId});break;case f.Trial:if(b.IsEntitlementExpired){k.resolve({status:c.TrialExpired,assetId:b.AssetId});break}var h=moment(),i=moment(b.EntitlementExpiryDate);k.resolve({status:c.UnderTrial,daysLeft:i.diff(h,"days"),assetId:b.AssetId})}}function i(){var c=SP.ClientContext.get_current(),d=SP.Utilities.Utility.getAppLicenseInformation(c,a.productId),e=b.defer();return c.executeQueryAsync(function(){var a,b;if(d.get_count()>0){a=d.get_item(0).get_rawXMLLicenseToken(),b=encodeURIComponent(a);var f=new SP.WebRequestInfo;f.set_url(m+b),f.set_method("GET");var g=SP.WebProxy.invoke(c,f);c.executeQueryAsync(function(){var a=g.get_body();e.resolve(a)},function(a,b){e.reject(new RequestError(b))})}else e.reject(new RequestError("licenseCollection is empty"))},function(a,b){e.reject(new RequestError(b))}),e.promise}var j="faq_token",k=b.defer(),l=60,m="https://verificationservice.officeapps.live.com/ova/verificationagent.svc/rest/verify?token=";return{getLicenseStatus:function(){var a=d.load(j);return a?h(a):i().then(function(a){a?(d.save(j,a,l),h(a)):k.resolve({status:c.LicenseNotValid})},function(a){k.reject(a)}),k.promise}}}])}(),function(a){"use strict";angular.module("FaqApp.services").factory("processing",["$sce","$location","faqService",function(b,c,d){return{initilize:function(e){e.Resources=FAQRS,e.trustedHtml=function(a){return b.trustAsHtml(a)},e.go=function(a){c.path(a)},e.resizeParent=d.resizeParent,e.getInnerText=function(b){return a(String.format("<div>{0}</div>",b)).text().trim()}}}}])}(jQuery),function(){"use strict";angular.module("FaqApp.services").factory("storage",function(){return{save:function(a,b,c){var d=60*c*1e3,e={value:JSON.stringify(b),timestamp:(new Date).getTime()+d},f=LZString.compressToUTF16(JSON.stringify(e));return localStorage.setItem(a,f),b},load:function(a){var b=LZString.decompressFromUTF16(localStorage.getItem(a));if(!b)return!1;var c=JSON.parse(b);return(new Date).getTime()<c.timestamp&&JSON.parse(c.value)}}})}();